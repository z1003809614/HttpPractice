<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My HttpServer: /home/ubuntu/HttpPractice/myhttp/http/http_connection.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My HttpServer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b0548858ce53c595d2b0ae9aa647089e.html">myhttp</a></li><li class="navelem"><a class="el" href="dir_bb3296b614672f31f8ba7f5ac1cf82d5.html">http</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">http_connection.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="http__connection_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#ifndef __MYHTTP_HTTP_CONNECTION_H__</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#define __MYHTTP_HTTP_CONNECTION_H__</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;../socket_stream.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http_8h.html">http.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;../uri.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;../thread.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemyhttp.html">myhttp</a></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">namespace </span>http</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    {</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html">   34</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="structmyhttp_1_1http_1_1HttpResult.html">HttpResult</a>{</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">   36</a></span>&#160;            <span class="keyword">typedef</span> std::shared_ptr&lt;HttpResult&gt; <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">ptr</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3">   41</a></span>&#160;            <span class="keyword">enum class</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3">Error</a>{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3ae0aa021e21dddbd6d8cecec71e9cf564">OK</a> = 0,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a9ba423abc90614e7ec03992f6484517a">INVALID_URL</a> = 1,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a8ec92b8be851c2c9f935c17f94310401">INVALID_HOST</a> = 2,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3adca3fec5c248b241263e8a63b7abaf9d">CONNECT_FAIL</a> = 3,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a4eb3ef838bd587136925ddfa42206a51">SEND_CLOSE_BY_PEER</a> = 4,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3aa20970543da334c5772bb5de140fb47f">SEND_SOCKET_ERROR</a> = 5,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a070a0fb40f6c308ab544b227660aadff">TIMEOUT</a> = 6,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a5459c7f06ce10ec753e440f8d1613aba">CREATE_SOCKET_ERROR</a> = 7,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a3c96e045074fe542e6b8a5dea8331102">POOL_GET_CONNECTION</a> = 8,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a61454a702ca29f60f09ea881dbdad142">POOL_INVALID_CONNECTION</a> = 9,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            };</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html#a600d33c88c1d4a2c6c7829537e1b306f">   70</a></span>&#160;            <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#a600d33c88c1d4a2c6c7829537e1b306f">HttpResult</a>(<span class="keywordtype">int</span> _result, <a class="code" href="classmyhttp_1_1http_1_1HttpResponse.html#a4035dbb834c59be6e3a8e97d06d95d0a">HttpResponse::ptr</a> _response, <span class="keyword">const</span> std::string&amp; _error)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                :<a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab8656bf8dddf40a08b346a90635407c9">result</a>(_result)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                ,<a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#aaa106ab4f3a7bf4e79031e1fa424eda8">response</a>(_response)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                ,<a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#a68c327803380025ade32c76e2b88fdef">error</a>(_error){}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html#ab8656bf8dddf40a08b346a90635407c9">   77</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#ab8656bf8dddf40a08b346a90635407c9">result</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html#aaa106ab4f3a7bf4e79031e1fa424eda8">   79</a></span>&#160;            <a class="code" href="classmyhttp_1_1http_1_1HttpResponse.html#a4035dbb834c59be6e3a8e97d06d95d0a">HttpResponse::ptr</a> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#aaa106ab4f3a7bf4e79031e1fa424eda8">response</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structmyhttp_1_1http_1_1HttpResult.html#a68c327803380025ade32c76e2b88fdef">   81</a></span>&#160;            std::string <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#a68c327803380025ade32c76e2b88fdef">error</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            std::string <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#a3759fd1f38ce55b50430b7dc71808668">toString</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        };</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">class </span><a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html">HttpConnectionPool</a>;   <span class="comment">// 提前进行声明否则下面的类不能使用；</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classmyhttp_1_1http_1_1HttpConnection.html">   95</a></span>&#160;<span class="comment"></span>        <span class="keyword">class </span><a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html">HttpConnection</a> : <span class="keyword">public</span> <a class="code" href="classmyhttp_1_1SocketStream.html">SocketStream</a>{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html">HttpConnectionPool</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keyword">public</span>:</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classmyhttp_1_1http_1_1HttpConnection.html#aa659442cfff99172f0e89447c5d6cad5">  100</a></span>&#160;                <span class="keyword">typedef</span> std::shared_ptr&lt;HttpConnection&gt; <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#aa659442cfff99172f0e89447c5d6cad5">ptr</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a7110402e53495c2e4453283e210d9bc8">DoGet</a>(<span class="keyword">const</span> std::string&amp; url</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                            ,uint64_t timeout_ms</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                            ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                            ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a7110402e53495c2e4453283e210d9bc8">DoGet</a>(<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                            ,uint64_t timeout_ms</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                            ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                            ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#aa6262a23ca3e9da80836281399365c4b">DoPost</a>(<span class="keyword">const</span> std::string&amp; url</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                            ,uint64_t timeout_ms</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                            ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                            ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#aa6262a23ca3e9da80836281399365c4b">DoPost</a>(<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                            ,uint64_t timeout_ms</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                            ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                            ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a1b6e4c8f2f3b0745dc02f29df3ac20f3">DoRequest</a>(HttpMethod method</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                ,<span class="keyword">const</span> std::string&amp; url</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                ,uint64_t timeout_ms</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                                ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a1b6e4c8f2f3b0745dc02f29df3ac20f3">DoRequest</a>(HttpMethod method</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                                ,<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                                ,uint64_t timeout_ms</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                                ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                                ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keyword">static</span> <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a1b6e4c8f2f3b0745dc02f29df3ac20f3">DoRequest</a>(<a class="code" href="classmyhttp_1_1http_1_1HttpRequest.html#a87f450a880f12ece3a24494c7e5d9145">HttpRequest::ptr</a> req</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                ,<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                                ,uint64_t timeout_ms);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a724cf83a2f5ca6c5e4826e901d651162">HttpConnection</a>(Socket::ptr sock, <span class="keywordtype">bool</span> owner = <span class="keyword">true</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#a157dde3dfec746ad2d1db53ef7aa2855">~HttpConnection</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <a class="code" href="classmyhttp_1_1http_1_1HttpResponse.html#a4035dbb834c59be6e3a8e97d06d95d0a">HttpResponse::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#ae6eb65d242aeb26a7178c0adaeff4af2">recvResponse</a>();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#ac27bd55de3435162d651a9a172c925c4">sendRequest</a>(<a class="code" href="classmyhttp_1_1http_1_1HttpRequest.html#a87f450a880f12ece3a24494c7e5d9145">HttpRequest::ptr</a> req);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keyword">private</span>:</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                uint64_t m_createTime = 0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                uint64_t m_request = 0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        };</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="classmyhttp_1_1http_1_1HttpConnectionPool.html">  236</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html">HttpConnectionPool</a>{</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keyword">public</span>:</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a32c80d14c99391eb8e2f735856689f4d">  239</a></span>&#160;                <span class="keyword">typedef</span> std::shared_ptr&lt;HttpConnectionPool&gt; <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a32c80d14c99391eb8e2f735856689f4d">ptr</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a3fe448804e2f7ba329b9222f797eb2aa">  241</a></span>&#160;                <span class="keyword">typedef</span> <a class="code" href="classmyhttp_1_1Mutex.html">Mutex</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a3fe448804e2f7ba329b9222f797eb2aa">MutexType</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a62ede73783461a69b69ac599246ec2e7">HttpConnectionPool</a> (<span class="keyword">const</span> std::string&amp; host</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                    ,<span class="keyword">const</span> std::string&amp; vhost</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                    ,uint32_t port</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                    ,uint32_t max_size</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                    ,uint32_t alive_time</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                    ,uint32_t max_request);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <a class="code" href="classmyhttp_1_1http_1_1HttpConnection.html#aa659442cfff99172f0e89447c5d6cad5">HttpConnection::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#ab66f7924969de16f3f74fc5a8ddef4ee">getConnection</a>();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a54de4b00caaa65c9171f015f685ad0a4">doGet</a>(<span class="keyword">const</span> std::string&amp; url</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                    ,uint64_t timeout_ms</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                    ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                    ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a54de4b00caaa65c9171f015f685ad0a4">doGet</a>(<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                    ,uint64_t timeout_ms</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                    ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                    ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a62633094c4e8dfa32009e80b9a27529c">doPost</a>(<span class="keyword">const</span> std::string&amp; url</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                    ,uint64_t timeout_ms</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                    ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                    ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a62633094c4e8dfa32009e80b9a27529c">doPost</a>(<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                    ,uint64_t timeout_ms</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                    ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                    ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a0773b01baacd076e56070367a4122fe5">doRequest</a>(HttpMethod method</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                        ,<span class="keyword">const</span> std::string&amp; url</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                        ,uint64_t timeout_ms</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                        ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                        ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a0773b01baacd076e56070367a4122fe5">doRequest</a>(HttpMethod method</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                        ,<a class="code" href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">Uri::ptr</a> uri</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                        ,uint64_t timeout_ms</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                        ,<span class="keyword">const</span> std::map&lt;std::string, std::string&gt;&amp; headers = {}</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                        ,<span class="keyword">const</span> std::string&amp; body = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">HttpResult::ptr</a> <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a0773b01baacd076e56070367a4122fe5">doRequest</a>(<a class="code" href="classmyhttp_1_1http_1_1HttpRequest.html#a87f450a880f12ece3a24494c7e5d9145">HttpRequest::ptr</a> req</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                        ,uint64_t timeout_ms);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keyword">private</span>:</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keyword">static</span> <span class="keywordtype">void</span> ReleasePtr(HttpConnection* <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a32c80d14c99391eb8e2f735856689f4d">ptr</a>, <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a62ede73783461a69b69ac599246ec2e7">HttpConnectionPool</a>* pool);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keyword">private</span>:</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                std::string m_host;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                std::string m_vhost;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                uint32_t m_port;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                uint32_t m_maxSize;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                uint32_t m_maxAliveTime;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                uint32_t m_maxRequest;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <a class="code" href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a3fe448804e2f7ba329b9222f797eb2aa">MutexType</a> m_mutex;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                std::list&lt;HttpConnection*&gt; m_conns;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                std::atomic&lt;int32_t&gt; m_total = {0};</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        };</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    } <span class="comment">// namespace http</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;} <span class="comment">// namespace myhttp</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a9ba423abc90614e7ec03992f6484517a"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a9ba423abc90614e7ec03992f6484517a">myhttp::http::HttpResult::Error::INVALID_URL</a></div><div class="ttdeci">@ INVALID_URL</div><div class="ttdoc">非法URL</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_acd2ad7803da5a68465667f521afd6213"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#acd2ad7803da5a68465667f521afd6213">myhttp::http::HttpResult::ptr</a></div><div class="ttdeci">std::shared_ptr&lt; HttpResult &gt; ptr</div><div class="ttdoc">智能指针重定义</div><div class="ttdef"><b>Definition:</b> http_connection.h:36</div></div>
<div class="ttc" id="anamespacemyhttp_html"><div class="ttname"><a href="namespacemyhttp.html">myhttp</a></div><div class="ttdoc">用于不适合复制的类来继承，简化其他类的代码</div><div class="ttdef"><b>Definition:</b> address.cpp:9</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_a3fe448804e2f7ba329b9222f797eb2aa"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a3fe448804e2f7ba329b9222f797eb2aa">myhttp::http::HttpConnectionPool::MutexType</a></div><div class="ttdeci">Mutex MutexType</div><div class="ttdoc">互斥量</div><div class="ttdef"><b>Definition:</b> http_connection.h:241</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_aaa106ab4f3a7bf4e79031e1fa424eda8"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#aaa106ab4f3a7bf4e79031e1fa424eda8">myhttp::http::HttpResult::response</a></div><div class="ttdeci">HttpResponse::ptr response</div><div class="ttdoc">HTTP响应结构体</div><div class="ttdef"><b>Definition:</b> http_connection.h:79</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_a3759fd1f38ce55b50430b7dc71808668"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#a3759fd1f38ce55b50430b7dc71808668">myhttp::http::HttpResult::toString</a></div><div class="ttdeci">std::string toString() const</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:13</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_a7110402e53495c2e4453283e210d9bc8"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#a7110402e53495c2e4453283e210d9bc8">myhttp::http::HttpConnection::DoGet</a></div><div class="ttdeci">static HttpResult::ptr DoGet(const std::string &amp;url, uint64_t timeout_ms, const std::map&lt; std::string, std::string &gt; &amp;headers={}, const std::string &amp;body=&quot;&quot;)</div><div class="ttdoc">发送HTTP的GET请求</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:169</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_a62633094c4e8dfa32009e80b9a27529c"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a62633094c4e8dfa32009e80b9a27529c">myhttp::http::HttpConnectionPool::doPost</a></div><div class="ttdeci">HttpResult::ptr doPost(const std::string &amp;url, uint64_t timeout_ms, const std::map&lt; std::string, std::string &gt; &amp;headers={}, const std::string &amp;body=&quot;&quot;)</div><div class="ttdoc">发送HTTP的POST请求</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:434</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a070a0fb40f6c308ab544b227660aadff"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a070a0fb40f6c308ab544b227660aadff">myhttp::http::HttpResult::Error::TIMEOUT</a></div><div class="ttdeci">@ TIMEOUT</div><div class="ttdoc">超时</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpRequest_html_a87f450a880f12ece3a24494c7e5d9145"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpRequest.html#a87f450a880f12ece3a24494c7e5d9145">myhttp::http::HttpRequest::ptr</a></div><div class="ttdeci">std::shared_ptr&lt; HttpRequest &gt; ptr</div><div class="ttdoc">HTTP请求的智能指针</div><div class="ttdef"><b>Definition:</b> http.h:244</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a4eb3ef838bd587136925ddfa42206a51"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a4eb3ef838bd587136925ddfa42206a51">myhttp::http::HttpResult::Error::SEND_CLOSE_BY_PEER</a></div><div class="ttdeci">@ SEND_CLOSE_BY_PEER</div><div class="ttdoc">连接被对方关闭</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a61454a702ca29f60f09ea881dbdad142"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a61454a702ca29f60f09ea881dbdad142">myhttp::http::HttpResult::Error::POOL_INVALID_CONNECTION</a></div><div class="ttdeci">@ POOL_INVALID_CONNECTION</div><div class="ttdoc">无效的连接</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3">myhttp::http::HttpResult::Error</a></div><div class="ttdeci">Error</div><div class="ttdoc">错误码定义</div><div class="ttdef"><b>Definition:</b> http_connection.h:41</div></div>
<div class="ttc" id="aclassmyhttp_1_1Mutex_html"><div class="ttname"><a href="classmyhttp_1_1Mutex.html">myhttp::Mutex</a></div><div class="ttdoc">互斥量</div><div class="ttdef"><b>Definition:</b> thread.h:210</div></div>
<div class="ttc" id="aclassmyhttp_1_1SocketStream_html"><div class="ttname"><a href="classmyhttp_1_1SocketStream.html">myhttp::SocketStream</a></div><div class="ttdoc">Socket流</div><div class="ttdef"><b>Definition:</b> socket_stream.h:22</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a3c96e045074fe542e6b8a5dea8331102"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a3c96e045074fe542e6b8a5dea8331102">myhttp::http::HttpResult::Error::POOL_GET_CONNECTION</a></div><div class="ttdeci">@ POOL_GET_CONNECTION</div><div class="ttdoc">从连接池中取连接失败</div></div>
<div class="ttc" id="aclassmyhttp_1_1Uri_html_a88e4fdc02b86b2923c86f2ba1b44dfbc"><div class="ttname"><a href="classmyhttp_1_1Uri.html#a88e4fdc02b86b2923c86f2ba1b44dfbc">myhttp::Uri::ptr</a></div><div class="ttdeci">std::shared_ptr&lt; Uri &gt; ptr</div><div class="ttdoc">只能指针定义</div><div class="ttdef"><b>Definition:</b> uri.h:37</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_a724cf83a2f5ca6c5e4826e901d651162"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#a724cf83a2f5ca6c5e4826e901d651162">myhttp::http::HttpConnection::HttpConnection</a></div><div class="ttdeci">HttpConnection(Socket::ptr sock, bool owner=true)</div><div class="ttdoc">构造函数</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:24</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_a62ede73783461a69b69ac599246ec2e7"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a62ede73783461a69b69ac599246ec2e7">myhttp::http::HttpConnectionPool::HttpConnectionPool</a></div><div class="ttdeci">HttpConnectionPool(const std::string &amp;host, const std::string &amp;vhost, uint32_t port, uint32_t max_size, uint32_t alive_time, uint32_t max_request)</div><div class="ttdoc">连接池构造函数</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:315</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_ae6eb65d242aeb26a7178c0adaeff4af2"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#ae6eb65d242aeb26a7178c0adaeff4af2">myhttp::http::HttpConnection::recvResponse</a></div><div class="ttdeci">HttpResponse::ptr recvResponse()</div><div class="ttdoc">接收socket的数据并进行分析处理，返回一个HttpRequest对象；</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:32</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html">myhttp::http::HttpConnection</a></div><div class="ttdoc">HTTP客户端类</div><div class="ttdef"><b>Definition:</b> http_connection.h:95</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_a32c80d14c99391eb8e2f735856689f4d"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a32c80d14c99391eb8e2f735856689f4d">myhttp::http::HttpConnectionPool::ptr</a></div><div class="ttdeci">std::shared_ptr&lt; HttpConnectionPool &gt; ptr</div><div class="ttdoc">智能指针重定义；</div><div class="ttdef"><b>Definition:</b> http_connection.h:239</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3adca3fec5c248b241263e8a63b7abaf9d"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3adca3fec5c248b241263e8a63b7abaf9d">myhttp::http::HttpResult::Error::CONNECT_FAIL</a></div><div class="ttdeci">@ CONNECT_FAIL</div><div class="ttdoc">连接失败</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_ab66f7924969de16f3f74fc5a8ddef4ee"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#ab66f7924969de16f3f74fc5a8ddef4ee">myhttp::http::HttpConnectionPool::getConnection</a></div><div class="ttdeci">HttpConnection::ptr getConnection()</div><div class="ttdoc">从pool中获取一个connection 内部实现了对invalid_connection的清除；</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:330</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_a68c327803380025ade32c76e2b88fdef"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#a68c327803380025ade32c76e2b88fdef">myhttp::http::HttpResult::error</a></div><div class="ttdeci">std::string error</div><div class="ttdoc">错误描述</div><div class="ttdef"><b>Definition:</b> http_connection.h:81</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html">myhttp::http::HttpResult</a></div><div class="ttdoc">Http响应结果封装类</div><div class="ttdef"><b>Definition:</b> http_connection.h:34</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3ae0aa021e21dddbd6d8cecec71e9cf564"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3ae0aa021e21dddbd6d8cecec71e9cf564">myhttp::http::HttpResult::Error::OK</a></div><div class="ttdeci">@ OK</div><div class="ttdoc">正常</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab8656bf8dddf40a08b346a90635407c9"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab8656bf8dddf40a08b346a90635407c9">myhttp::http::HttpResult::result</a></div><div class="ttdeci">int result</div><div class="ttdoc">错误码</div><div class="ttdef"><b>Definition:</b> http_connection.h:77</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_a0773b01baacd076e56070367a4122fe5"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a0773b01baacd076e56070367a4122fe5">myhttp::http::HttpConnectionPool::doRequest</a></div><div class="ttdeci">HttpResult::ptr doRequest(HttpMethod method, const std::string &amp;url, uint64_t timeout_ms, const std::map&lt; std::string, std::string &gt; &amp;headers={}, const std::string &amp;body=&quot;&quot;)</div><div class="ttdoc">发送HTTP请求</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:458</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_aa6262a23ca3e9da80836281399365c4b"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#aa6262a23ca3e9da80836281399365c4b">myhttp::http::HttpConnection::DoPost</a></div><div class="ttdeci">static HttpResult::ptr DoPost(const std::string &amp;url, uint64_t timeout_ms, const std::map&lt; std::string, std::string &gt; &amp;headers={}, const std::string &amp;body=&quot;&quot;)</div><div class="ttdoc">发送HTTP的POST请求</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:190</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_a600d33c88c1d4a2c6c7829537e1b306f"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#a600d33c88c1d4a2c6c7829537e1b306f">myhttp::http::HttpResult::HttpResult</a></div><div class="ttdeci">HttpResult(int _result, HttpResponse::ptr _response, const std::string &amp;_error)</div><div class="ttdoc">构造函数</div><div class="ttdef"><b>Definition:</b> http_connection.h:70</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_a1b6e4c8f2f3b0745dc02f29df3ac20f3"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#a1b6e4c8f2f3b0745dc02f29df3ac20f3">myhttp::http::HttpConnection::DoRequest</a></div><div class="ttdeci">static HttpResult::ptr DoRequest(HttpMethod method, const std::string &amp;url, uint64_t timeout_ms, const std::map&lt; std::string, std::string &gt; &amp;headers={}, const std::string &amp;body=&quot;&quot;)</div><div class="ttdoc">发送HTTP请求</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:211</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html_a54de4b00caaa65c9171f015f685ad0a4"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html#a54de4b00caaa65c9171f015f685ad0a4">myhttp::http::HttpConnectionPool::doGet</a></div><div class="ttdeci">HttpResult::ptr doGet(const std::string &amp;url, uint64_t timeout_ms, const std::map&lt; std::string, std::string &gt; &amp;headers={}, const std::string &amp;body=&quot;&quot;)</div><div class="ttdoc">发送HTTP的GET请求</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:410</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_ac27bd55de3435162d651a9a172c925c4"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#ac27bd55de3435162d651a9a172c925c4">myhttp::http::HttpConnection::sendRequest</a></div><div class="ttdeci">int sendRequest(HttpRequest::ptr req)</div><div class="ttdoc">把封装好的response对象序列化发送出去； 1.内部使用了ScoketStream类的方法</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:160</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3aa20970543da334c5772bb5de140fb47f"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3aa20970543da334c5772bb5de140fb47f">myhttp::http::HttpResult::Error::SEND_SOCKET_ERROR</a></div><div class="ttdeci">@ SEND_SOCKET_ERROR</div><div class="ttdoc">发送请求产生Socket错误</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpResponse_html_a4035dbb834c59be6e3a8e97d06d95d0a"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpResponse.html#a4035dbb834c59be6e3a8e97d06d95d0a">myhttp::http::HttpResponse::ptr</a></div><div class="ttdeci">std::shared_ptr&lt; HttpResponse &gt; ptr</div><div class="ttdoc">HTTP响应结构智能指针</div><div class="ttdef"><b>Definition:</b> http.h:573</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnectionPool_html"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnectionPool.html">myhttp::http::HttpConnectionPool</a></div><div class="ttdoc">HTTP客户端连接池</div><div class="ttdef"><b>Definition:</b> http_connection.h:236</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a8ec92b8be851c2c9f935c17f94310401"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a8ec92b8be851c2c9f935c17f94310401">myhttp::http::HttpResult::Error::INVALID_HOST</a></div><div class="ttdeci">@ INVALID_HOST</div><div class="ttdoc">无法解析的HOST</div></div>
<div class="ttc" id="ahttp_8h_html"><div class="ttname"><a href="http_8h.html">http.h</a></div><div class="ttdoc">HTTP定义结构体封装</div></div>
<div class="ttc" id="astructmyhttp_1_1http_1_1HttpResult_html_ab55f868e1a864cc509f7c38f93bffbf3a5459c7f06ce10ec753e440f8d1613aba"><div class="ttname"><a href="structmyhttp_1_1http_1_1HttpResult.html#ab55f868e1a864cc509f7c38f93bffbf3a5459c7f06ce10ec753e440f8d1613aba">myhttp::http::HttpResult::Error::CREATE_SOCKET_ERROR</a></div><div class="ttdeci">@ CREATE_SOCKET_ERROR</div><div class="ttdoc">创建Socket失败</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_aa659442cfff99172f0e89447c5d6cad5"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#aa659442cfff99172f0e89447c5d6cad5">myhttp::http::HttpConnection::ptr</a></div><div class="ttdeci">std::shared_ptr&lt; HttpConnection &gt; ptr</div><div class="ttdoc">HTTP客户端类智能指针</div><div class="ttdef"><b>Definition:</b> http_connection.h:100</div></div>
<div class="ttc" id="aclassmyhttp_1_1http_1_1HttpConnection_html_a157dde3dfec746ad2d1db53ef7aa2855"><div class="ttname"><a href="classmyhttp_1_1http_1_1HttpConnection.html#a157dde3dfec746ad2d1db53ef7aa2855">myhttp::http::HttpConnection::~HttpConnection</a></div><div class="ttdeci">~HttpConnection()</div><div class="ttdoc">析构函数</div><div class="ttdef"><b>Definition:</b> http_connection.cpp:28</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
